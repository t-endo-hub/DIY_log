<div class=container>
  <div class="row">
		<%= render 'partial/back_btn' %>
		<div class="col-lg-12">
			<div class="home-content new-bottom margin-bottom10 text-center">
				<i class="fas fa-comment icon new-bg"></i>投稿編集
			</div>
		</div>
	</div>
<%= form_for(@post) do |f| %>
		<div class="row" style="margin-top: 30px">
				<div class="col-lg-6">
					<%= attachment_image_tag @post, :image, format: "jpg", fallback: "no_pic.png", class: "post-image-show", id:"preview-image" %>
					<%= f.attachment_field :image, id: "select-image", style: "margin: 10px 0" %><br>

					<script type="text/javascript">
					$(function() {
					function readURL(input) {
						if (input.files && input.files[0]) {
							var reader = new FileReader();
							reader.onload = function (e) {
								$('#preview-image').attr('src', e.target.result);
							}
							reader.readAsDataURL(input.files[0]);
						}
					}
					$("#select-image").change(function(){
						readURL(this);
					});
					});
					</script>

					<div style="margin-top: 30px;"><strong>タグ(間にはカンマ , をつけて下さい)</strong></div>
					<%= f.text_field :tag_list, value: @post.tag_list.join(','), class: "form-control", placeholder: "壁,机、、、" %>
				</div>
				<div class="col-lg-6">
					<ul>
						<% @post.errors.full_messages.each do |message| %>
							<div class="bad-flash"><i class="fas fa-exclamation-circle"></i>
								<%= message %>
							</div>
						<% end %>
					</ul>
					<h3 class="post-title" style="margin-bottom: 40px;" >レシピ</h3>
					<div class="row">
						<div class="col-lg-3"><strong>作品名</strong></div>
						<div class="col-lg-9"><p><%= f.text_field :title, autocomplete: "off", style: "width:80%", placeholder: "作品名" %></p></div>
					</div>
					<div class="row">
						<div class="col-lg-3"><strong>説明</strong></div>
						<div class="col-lg-9"><p><%= f.text_area :content, autocomplete: "off", rows: "3", style: "width:100%", placeholder: "ポイント、特徴など" %></p></div>
					</div>
					<div style="text-align: center;margin: 20px 0">
						<%= f.submit class:"btn btn-primary" %>
					</div>
				</div>
		</div>
	<% end %>
  <div class="row">
    <div class="col-md-6">
      <h4 class="recipe-title">材料</h4>
      <div class="materials_form_<%= @post.id %>">
        <%= render 'recipes/materials_form', materials: @materials, post: @post %>
      </div>

      <%= form_for [@post,@material],remote: true do |f| %>
      <div class="row pt-2">
        <div class="col-lg-5 col-4">
          <%= f.text_field :name, placeholder: "材料", class: 'materials_form' %>
        </div>
        <div class="col-lg-2 col-2">
          <%= f.text_field :quantity, :size=>"8",placeholder:"数量",class: 'materials_form' %>
        </div>
        <div class="col-lg-3 col-4">
          <%= f.submit "追加", class: "btn btn-primary" %>
        </div>
      </div>
      <% end %>
    </div>

    <div class="col-md-6">
      <h4 class="recipe-title">使用工具</h4>
      <div class="items_form_<%= @post.id %>">
        <%= render 'recipes/items_form', items: @items, post: @post %>
      </div>

      <%= form_for [@post,@item],remote: true do |f| %>
        <div class="row pt-2">
          <div class="col-lg-5">
            <%= f.text_field :name, placeholder:"工具", class: 'items_form' %>
          </div>
          <div class="col-lg-3">
            <%= f.submit "追加", class: "btn btn-primary" %>
          </div>
        </div>
      <% end %>
    </div>
  </div>

  <h4 class="recipe-title">作り方</h4>

  <div class="recipes_form_<%= @post.id %>">
    <%= render 'recipes/recipes_form', recipes: @recipes, post: @post %>
  </div>

  <div class="row" style="margin-bottom: 10px">
    <div class="col-lg-3 col-3">
      <%= form_for [@post,@recipe],remote: true do |f| %>
        <%= attachment_image_tag @recipe, :image, id:"recipe-prev", class:"recipes_form", fallback: "no_pic.png" %>
        <div class="upload-btn-wrapper">
          <%= f.file_field :image, id:"recipe-image", class:'recipes_form', accept: 'image/jpeg,image/gif,image/png', onChange:'inform()' %>
          <button class="btn-type">画像を選択する</button>
        </div>
        <%= f.text_area :content, rows:"2",style:"width:100%",placeholder:"作り方を入力する", class:'recipes_form input-form' %>
        <%= f.submit "追加", class:"btn btn-primary submit-btn-sm" %>
      <% end %>
    </div>
  </div>
  <div class="text-center my-4">
    <%= link_to '投稿する', root_path, class: 'btn btn-success' %>
  </div>

</div>